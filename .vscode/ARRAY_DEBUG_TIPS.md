# 如何在 VS Code 中查看数组

## 问题说明
在调试 C++ 程序时，查看数组值有几种方法。

## 方法一：变量面板（推荐）

### 步骤：
1. 在代码中设置断点（例如在 `divide_decimal` 调用之后）
2. 按 F5 启动调试
3. 在左侧**变量（VARIABLES）**面板中找到 `ans` 变量
4. 点击 `ans` 左侧的展开箭头（▶）
5. 可以看到数组的所有元素：`ans[0]`, `ans[1]`, `ans[2]`, ...

### 示例：
```
▼ Locals
  ▶ ans  int[10]
    [0]  0
    [1]  3
    [2]  3
    [3]  3
    ...
```

## 方法二：监视面板

### 步骤：
1. 在调试时，右键点击**监视（WATCH）**面板
2. 点击"添加表达式"
3. 输入以下表达式之一：

#### 查看整个数组：
```
ans
```

#### 查看特定元素：
```
ans[0]
ans[1]
ans[2]
```

#### 查看数组范围（GDB 语法）：
```
*ans@10
```
这会显示从 `ans[0]` 开始的 10 个元素

#### 查看部分数组：
```
*ans@5
```
只显示前 5 个元素

## 方法三：调试控制台

### 步骤：
1. 在调试暂停时，打开**调试控制台（DEBUG CONSOLE）**
2. 输入 GDB 命令：

```gdb
-exec print ans
-exec print *ans@10
-exec print ans[0]
-exec print ans[1]
```

## 方法四：鼠标悬停

### 步骤：
1. 调试暂停时
2. 将鼠标悬停在代码中的 `ans` 变量上
3. 会弹出一个提示框显示数组内容
4. 点击展开箭头查看所有元素

## 常见问题

### Q1: 数组显示为 `{...}` 无法展开？
**原因**：数组尚未初始化或不在当前作用域
**解决**：
- 确保断点设置在数组被初始化**之后**
- 对于 `decimal.cpp`，应该在第 32 行之后设置断点

### Q2: 数组值显示为乱码或很大的数字？
**原因**：数组未初始化
**解决**：在声明时初始化数组
```cpp
int ans[10] = {0};  // 初始化为全 0
```

### Q3: 只能看到第一个元素？
**原因**：VS Code 默认折叠大数组
**解决**：
- 点击变量左侧的展开箭头
- 或在监视面板使用 `*ans@10` 语法

### Q4: 数组太大，显示不全？
**解决**：
1. 在监视面板使用切片语法：
   - `*ans@5` - 显示前 5 个
   - `*(ans+5)@5` - 显示第 6-10 个元素
2. 使用调试控制台打印：
   ```
   -exec print *ans@100
   ```

## 针对 decimal.cpp 的调试建议

### 推荐断点位置：
```cpp
int main() {
  int ans[10];
  divide_decimal(1, 3, ans, 9);  // ← 在这行之后设置断点（第 32 行）
  print_decimal(ans, 3);          // ← 或在这行设置断点（第 33 行）
}
```

### 在断点处可以查看：
- **变量面板**：
  - `ans` - 数组的所有元素
  - 每个 `ans[i]` 的值

- **监视面板添加**：
  ```
  *ans@10          // 查看所有 10 个元素
  *ans@4           // 查看前 4 个元素（0.033）
  ans[0]           // 第一位小数
  ans[1]           // 第二位小数
  ```

## 高级技巧

### 1. 在调试控制台使用 GDB 命令
```gdb
-exec print ans                    # 打印数组
-exec print *ans@10                # 打印 10 个元素
-exec print sizeof(ans)/sizeof(ans[0])  # 数组大小
-exec x/10dw ans                   # 以十进制字（word）格式显示 10 个元素
-exec set print array on           # 启用数组美化打印
-exec set print array-indexes on   # 显示数组索引
```

### 2. 条件断点
右键断点 → 编辑断点 → 添加条件：
```cpp
ans[0] == 3      // 当第一个元素为 3 时才中断
p > 5            // 在 divide_decimal 中，当 p > 5 时中断
```

### 3. 日志点（Logpoint）
不暂停程序，只打印信息：
1. 右键行号 → 添加日志点
2. 输入：`ans = {*ans@10}`
3. 程序运行时会在调试控制台输出数组值

## 快速测试

运行以下命令测试 GDB 是否正常工作：
```bash
cd /home/yehj/repos/algo/prac
g++ -g decimal.cpp -O0 -std=c++17 -o decimal_test

gdb -q decimal_test <<EOF
set debuginfod enabled off
break 32
run
next
print ans
print *ans@10
quit
EOF
```

如果 GDB 可以显示数组，那么 VS Code 也应该可以。如果还不行，检查：
1. 是否使用了 "Debug Active File" 配置
2. 是否在正确的位置设置了断点
3. C/C++ 扩展是否已启用

## 截图说明

调试时应该看到：
```
VARIABLES
  ▼ Locals
    ▶ ans     int [10]
      [0]     0
      [1]     3
      [2]     3
      [3]     3
      [4]     3
      [5]     3
      [6]     3
      [7]     3
      [8]     3
      [9]     3
```

如果看不到这样的显示，请检查：
- 断点是否在 `divide_decimal` 调用**之后**
- 是否已经执行到断点（程序应该暂停）
- 左侧调试面板是否打开
